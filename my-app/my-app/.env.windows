# Windows Production Environment Configuration
# Optimized for Windows Server and Desktop deployment (x86_64)

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================
NODE_ENV=production
APP_PORT=3000
APP_NAME=my-multiplatform-app

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=myapp_prod
POSTGRES_USER=postgres
POSTGRES_PASSWORD=SecurePassword123!

DATABASE_URL=postgresql://postgres:SecurePassword123!@postgres:5432/myapp_prod

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=RedisSecurePassword123!

REDIS_URL=redis://:RedisSecurePassword123!@redis:6379/0

# ============================================================================
# PRODUCTION SETTINGS
# ============================================================================
LOG_LEVEL=warn
LOG_FORMAT=json

# Security
JWT_SECRET=windows-production-jwt-secret-change-this-to-random-string
BCRYPT_SALT_ROUNDS=12

# ============================================================================
# DOCKER SETTINGS (Windows)
# ============================================================================
# Use AMD64 architecture for Windows deployment
DOCKER_DEFAULT_PLATFORM=linux/amd64
BUILDX_PLATFORMS=linux/amd64

# Windows Docker optimizations
COMPOSE_DOCKER_CLI_BUILD=1
DOCKER_BUILDKIT=1

# ============================================================================
# PLATFORM-SPECIFIC PATHS (Windows Container)
# ============================================================================
# Use Linux-style paths inside containers (even on Windows host)
POSTGRES_DATA_PATH=/app/data/postgres
REDIS_DATA_PATH=/app/data/redis
LOGS_PATH=/app/logs

# Windows host bind mount paths (if using bind mounts)
WINDOWS_POSTGRES_DATA_PATH=C:\docker-data\postgres
WINDOWS_REDIS_DATA_PATH=C:\docker-data\redis
WINDOWS_LOGS_PATH=C:\docker-logs

# ============================================================================
# PERFORMANCE OPTIMIZATIONS (Windows Production)
# ============================================================================
# Production resource allocation
APP_MEMORY_LIMIT=1G
APP_CPU_LIMIT=2.0
APP_MEMORY_RESERVATION=512M
APP_CPU_RESERVATION=1.0

POSTGRES_MEMORY_LIMIT=2G
POSTGRES_CPU_LIMIT=2.0
POSTGRES_MEMORY_RESERVATION=1G
POSTGRES_CPU_RESERVATION=1.0
POSTGRES_SHARED_BUFFERS=512MB
POSTGRES_EFFECTIVE_CACHE_SIZE=2GB
POSTGRES_MAINTENANCE_WORK_MEM=128MB

REDIS_MEMORY_LIMIT=1G
REDIS_CPU_LIMIT=1.0
REDIS_MEMORY_RESERVATION=512M
REDIS_CPU_RESERVATION=0.5

# ============================================================================
# NETWORK CONFIGURATION
# ============================================================================
NETWORK_SUBNET=172.21.0.0/16

# ============================================================================
# NGINX CONFIGURATION
# ============================================================================
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443

# SSL Configuration
SSL_ENABLED=true
SSL_CERT_PATH=/etc/nginx/ssl/cert.pem
SSL_KEY_PATH=/etc/nginx/ssl/key.pem

# ============================================================================
# HEALTH CHECK & MONITORING
# ============================================================================
HEALTH_CHECK_INTERVAL=60000
HEALTH_CHECK_TIMEOUT=10000
GRACEFUL_SHUTDOWN_TIMEOUT=15000

# Monitoring
MONITORING_ENABLED=true
METRICS_PORT=9090

# ============================================================================
# RATE LIMITING (Production)
# ============================================================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=1000

# ============================================================================
# EMAIL CONFIGURATION (Production)
# ============================================================================
EMAIL_SERVICE=smtp
EMAIL_HOST=smtp.office365.com
EMAIL_PORT=587
EMAIL_SECURE=false
EMAIL_USER=noreply@yourcompany.com
EMAIL_PASSWORD=YourEmailPassword

# ============================================================================
# FILE STORAGE
# ============================================================================
STORAGE_TYPE=local
STORAGE_PATH=C:\app-storage
MAX_FILE_SIZE=50mb

# ============================================================================
# LOGGING (Windows)
# ============================================================================
LOG_FILE=C:\app-logs\app.log
LOG_MAX_SIZE=100m
LOG_MAX_FILES=10
LOG_DATE_PATTERN=YYYY-MM-DD-HH

# Windows Event Log integration
WINDOWS_EVENT_LOG=true
EVENT_LOG_SOURCE=MyMultiplatformApp

# ============================================================================
# WINDOWS SPECIFIC SETTINGS
# ============================================================================
# Windows line ending handling
GIT_AUTOCRLF=true

# Windows service configuration
WINDOWS_SERVICE_NAME=MyMultiplatformApp
WINDOWS_SERVICE_DISPLAY_NAME=My Multiplatform Application

# Process management
PM2_INSTANCES=max
PM2_EXEC_MODE=cluster

# ============================================================================
# BACKUP CONFIGURATION
# ============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *
BACKUP_RETENTION_DAYS=30
BACKUP_PATH=C:\app-backups

# Database backup
DB_BACKUP_ENABLED=true
DB_BACKUP_ENCRYPTION=true

# ============================================================================
# SECURITY HARDENING
# ============================================================================
# Helmet configuration
HELMET_HSTS=true
HELMET_NO_SNIFF=true
HELMET_FRAME_GUARD=deny
HELMET_XSS_FILTER=true

# CORS (restrictive for production)
CORS_ORIGIN=https://yourdomain.com
CORS_CREDENTIALS=false

# Session security
SESSION_SECURE=true
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=strict